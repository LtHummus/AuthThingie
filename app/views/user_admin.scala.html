@import services.users.User
@import views.html.helper.CSRF
@(users: List[User])(implicit request: MessagesRequestHeader)

@main("User Admin") {
    <div class="container-fluid row py-3">
    @if(users.nonEmpty) {
        <h3>Users</h3>
        <div class="table-responsive">
            <table class="table table-striped table-sm user-table">
                <thead>
                    <tr>
                        <th scope="col">Username</th>
                        <th scope="col">Uses TOTP?</th>
                        <th scope="col">Duo Enabled?</th>
                        <th scope="col">Roles</th>
                        <th scope="col">Actions</th>
                    </tr>
                </thead>
                <tbody>
                @for(user <- users) {
                    <tr>
                        <td>
                        @user.username
                        </td>
                        <td>
                        @if(user.usesTotp) {
                            ✅
                        } else {
                            ❌
                        }
                        </td>
                        <td>
                        @if(user.duoEnabled) {
                            ✅
                        } else {
                            ❌
                        }
                        </td>
                        <td>
                            @if(user.admin) {
                                <span class="badge badge-danger">Admin</span>
                            }
                            @for(role <- user.roles) {
                                <span class="badge badge-primary">@role</span>
                            }
                        </td>
                        <td>
                            <!-- TODO: don't show this button for the logged in user -->
                            <form action="@routes.UserAdminController.deleteUser()" method="post">
                                @CSRF.formField
                                <input type="hidden" name="username" value="@user.username" />
                                <input type="submit" class="btn btn-danger" value="Delete" />
                            </form>
                        </td>
                    </tr>
                }
                </tbody>
            </table>
        </div>
    }
    </div>
    <div>
        <a href="@routes.HomeController.index()" class="btn btn-secondary">Home</a>
    </div>
}