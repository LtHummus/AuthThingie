@(showTotp: Boolean, form: Form[TotpData], postUrl: Call, error: Option[String], duoHost: Option[String], sigRequest: Option[String], duoAction: Call)(implicit request: MessagesRequestHeader)


    @main("TOTP") {
        @if(form.hasGlobalErrors) {
            @form.globalErrors.map { error: FormError =>
                <div>
                    Error: @error.key: @error.message
                </div>
            }
        }

        <div class="col col-sm-6 offset-md-3 login-form">
            <h3>Two-Factor Auth</h3>

            @if(error.isDefined) {
                <div class="alert alert-danger">
                @error.get
                </div>
            }

            @if(showTotp) {
                @b4.vertical.formCSRF(postUrl) { implicit vfc =>
                    @b4.text(form("totpCode"), Symbol("_label") -> "TOTP Code", Symbol("size") -> 10, Symbol("autofocus") -> "autofocus")

                    @b4.submit(Symbol("class") -> "btn btn-primary") {
                        <i class="fa fa-ok btn-submit"></i> Go }
                }
            }

            @if(duoHost.isDefined && sigRequest.isDefined) {
                <iframe id="duo_iframe">
                </iframe>
                <style>
                        #duo_iframe {
                            width: 100%;
                            min-width: 304px;
                            max-width: 620px;
                            height: 330px;
                            border: none;
                        }
                </style>

                <script src="@routes.Assets.versioned("javascripts/Duo-Web-V2.js")" type="text/javascript"></script>
                <script>
                        Duo.init({
                            'host': "@(duoHost.get)",
                            'sig_request': "@(sigRequest.get)",
                            'post_action': "@(duoAction.relative)"
                        });
                </script>
            }
        </div>
    }
